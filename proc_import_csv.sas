/*==============================================================================*/
/* note:       1.   Imports a CSV file into a SAS dataset.                      */
/*==============================================================================*/
%macro proc_import_csv(
datafile       = ,
out            = ,
DELIMITER      = COMMA,
termstr        = crlf,
getnames       = yes,
guessingrows   = 100
);

/*------------------------------------------------------------------------------*/
/* step 010    Convert termstr to lower case.                                   */
/*------------------------------------------------------------------------------*/

%let termstr = %lowcase(&termstr.);

/*------------------------------------------------------------------------------*/
/* step 020    Define the input filename statement.                             */
/*------------------------------------------------------------------------------*/

filename       myfile 
               "&datafile." 
               %if  &termstr. = crlf %then %do;
               termstr=&termstr.
               %end;
               ;

/*------------------------------------------------------------------------------*/
/* step 030    Generate the Proc Import statement.                              */
/*------------------------------------------------------------------------------*/

proc import 

     /*=========================================================================*/
     /* 1.     Specify the File statement on the Windows Platform.              */
     /*=========================================================================*/

     /*-------------------------------------------------------------------------*/
     /* 1.1    Specify the File statement on the Windows Platform.              */
     /*-------------------------------------------------------------------------*/


     datafile       = myfile      

     /*-------------------------------------------------------------------------*/
     /* 1.3    Specify the output sas dataset.                                  */
     /*-------------------------------------------------------------------------*/

     out            = &out.

     /*-------------------------------------------------------------------------*/
     /* 1.4    Specify the comma seperated value ( csv ) database access method */
     /*-------------------------------------------------------------------------*/

     dbms           = csv 

     /*-------------------------------------------------------------------------*/
     /* 1.5    Specify the replace option                                       */
     /*-------------------------------------------------------------------------*/

     replace;


     /*-------------------------------------------------------------------------*/
     /* 2.     Start reading the data on line 2.                                */
     /*-------------------------------------------------------------------------*/

     datarow        = 2;

     /*-------------------------------------------------------------------------*/
     /* 3.     Define the comma deliminator.                                    */
     /*-------------------------------------------------------------------------*/

     %IF  %UPCASE(&delimiter.)     = SEMICOLON    %then %do;

     delimiter      = ';';

     %end;

     %IF  %UPCASE(&delimiter.)     = COMMA        %then %do;

     delimiter      = ',';

     %end;

     %IF  %UPCASE(&delimiter.)     = BLANK        %then %do;

     delimiter      = ' ';

     %end;

     /*-------------------------------------------------------------------------*/
     /* 4.     Get the column names.                                            */
     /*-------------------------------------------------------------------------*/

     getnames       = &getnames.;

     /*-------------------------------------------------------------------------*/
     /* 5.     Get the guessing rows to determine the column data types.        */
     /*-------------------------------------------------------------------------*/

     guessingrows   = &guessingrows.;

run;


%mend;
/**/
/*%let dir  = t:\Transaction Migration\_TransferPortal;*/
/*%let file = trans_daily_cvdata_d20161108.csv;*/

/*%proc_import_csv(*/
/* datafile      = &dir.\&file.,*/
/* delimiter     = COMMA,*/
/* out           = appxdat.vic,*/
/* guessingrows  = 100*/
/* ); run;*/
